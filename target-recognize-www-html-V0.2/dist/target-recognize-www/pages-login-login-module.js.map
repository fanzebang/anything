{"version":3,"sources":["./src/app/pages/login/login-routing.module.ts","./src/app/pages/login/login.component.ts","./src/app/pages/login/login.component.html","./src/app/pages/login/login.module.ts"],"names":[],"mappings":"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","file":"pages-login-login-module.js","sourcesContent":["import {NgModule} from '@angular/core';\r\nimport {RouterModule} from '@angular/router';\r\nimport {LoginComponent} from './login.component';\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild([\r\n    {\r\n      path: '', component: LoginComponent\r\n    }\r\n  ])],\r\n  exports: [RouterModule]\r\n})\r\nexport class LoginRoutingModule {\r\n\r\n}\r\n","import {Component, OnInit} from '@angular/core';\r\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {HttpClient, HttpParams} from '@angular/common/http';\r\nimport {environment} from '../../../environments/environment';\r\nimport {HttpResult} from '../../core/http-entity';\r\nimport sha256 from 'crypto-js/sha256';\r\nimport Hex from 'crypto-js/enc-hex';\r\nimport {Router} from '@angular/router';\r\nimport {Store} from '@ngxs/store';\r\nimport {LoginAction} from '../../state/login.action';\r\n\r\n@Component({\r\n  templateUrl: './login.component.html',\r\n  styleUrls: ['./login.component.less']\r\n})\r\nexport class LoginComponent implements OnInit {\r\n  validateForm!: FormGroup;\r\n  errMsg: string;\r\n\r\n  constructor(private fb: FormBuilder, private http: HttpClient, private router: Router, private store: Store) {\r\n  }\r\n\r\n  submitForm(): void {\r\n    // tslint:disable-next-line:forin\r\n    for (const i in this.validateForm.controls) {\r\n      this.validateForm.controls[i].markAsDirty();\r\n      this.validateForm.controls[i].updateValueAndValidity();\r\n    }\r\n    if (this.validateForm.valid) {\r\n      const loginName = this.validateForm.controls.userName.value;\r\n      const saltUrlParams = new HttpParams().append('loginName', loginName);\r\n      // 先拿盐\r\n      this.http.get(`${environment.API_URL}/v1/login/salt`, {\r\n        params: saltUrlParams\r\n      }).subscribe((saltResult: HttpResult<string>) => {\r\n        if (HttpResult.succeed(saltResult.code)) {\r\n          // 将密码加盐后传给后台登录\r\n          const salt = saltResult.data;\r\n          const passwdHashHex = Hex.stringify(sha256(this.validateForm.controls.password.value));\r\n          const saltPasswdHashHex = Hex.stringify(sha256(loginName + passwdHashHex + salt));\r\n\r\n          this.http.post(`${environment.API_URL}/v1/login`, {\r\n            loginName,\r\n            passwd: saltPasswdHashHex\r\n          }).subscribe((loginResult: HttpResult<string>) => {\r\n            if (HttpResult.succeed(loginResult.code)) {\r\n              // 登录成功\r\n              var data = JSON.stringify(loginResult.data);\r\n                var data=JSON.stringify(loginResult.data);\r\n                var str=JSON.parse(data);\r\n                var jwt=JSON.stringify(str.jwt);\r\n                    jwt=jwt.substring(1,jwt.length-1);\r\n                var mgrPath=JSON.stringify(str.mgrPath);\r\n                    mgrPath=mgrPath.substring(1,mgrPath.length-1);\r\n                var dataCountHeaderPath=JSON.stringify(str.mgrPath);\r\n                    dataCountHeaderPath=dataCountHeaderPath.substring(1,dataCountHeaderPath.length-5);\r\n                var sampleResourcePath=JSON.stringify(str.sampleResourcePath);\r\n                    sampleResourcePath=sampleResourcePath.substring(1,sampleResourcePath.length-1);\r\n                var targetRecognizePath=JSON.stringify(str.targetRecognizePath);\r\n                    targetRecognizePath=targetRecognizePath.substring(1,targetRecognizePath.length-1);\r\n                var wsPath=JSON.stringify(str.wsPath);\r\n                    wsPath=wsPath.substring(1,wsPath.length-1);\r\n                var sfUrl=JSON.stringify(str.sfUrl);\r\n                    sfUrl=sfUrl.substring(1,sfUrl.length-1);\r\n                localStorage.setItem('Bearer', jwt);\r\n                localStorage.setItem('mgrPath', mgrPath);\r\n               localStorage.setItem('dataCountHeaderPath', dataCountHeaderPath);\r\n                 localStorage.setItem('sampleResourcePath', sampleResourcePath);\r\n                localStorage.setItem('targetRecognizePath',targetRecognizePath);\r\n                localStorage.setItem('wsPath',wsPath);\r\n                localStorage.setItem('sfUrl',sfUrl);\r\n                localStorage.setItem('homeLink','www.baidu.com');\r\n\r\n            //  alert(\"打印是的：\"+localStorage.getItem('wsPath'));\r\n              this.store.dispatch(new LoginAction(jwt)).subscribe(() => {\r\n                this.router.navigate(['/home']);\r\n              });\r\n\r\n            } else {\r\n              this.errMsg = loginResult.message;\r\n            }\r\n          });\r\n        } else {\r\n          this.errMsg = saltResult.message;\r\n        }\r\n\r\n      });\r\n\r\n    }\r\n  }\r\n\r\n\r\n  ngOnInit(): void {\r\n    this.validateForm = this.fb.group({\r\n      userName: [null, [Validators.required]],\r\n      password: [null, [Validators.required]],\r\n      remember: [true]\r\n    });\r\n  }\r\n}\r\n","<div>\r\n  <form nz-form [formGroup]=\"validateForm\" class=\"login-form\" (ngSubmit)=\"submitForm()\">\r\n    <nz-form-item>\r\n      <nz-form-control nzErrorTip=\"请输入用户名!\">\r\n        <nz-input-group nzPrefixIcon=\"user\">\r\n          <input type=\"text\" nz-input formControlName=\"userName\" placeholder=\"用户名\"/>\r\n        </nz-input-group>\r\n      </nz-form-control>\r\n    </nz-form-item>\r\n    <nz-form-item>\r\n      <nz-form-control nzErrorTip=\"请输入密码!\">\r\n        <nz-input-group nzPrefixIcon=\"lock\">\r\n          <input type=\"password\" nz-input formControlName=\"password\" placeholder=\"密码\"/>\r\n        </nz-input-group>\r\n      </nz-form-control>\r\n    </nz-form-item>\r\n\r\n    <!--\r\n    <div nz-row class=\"login-form-margin\">\r\n      <div nz-col [nzSpan]=\"12\">\r\n        <label nz-checkbox formControlName=\"remember\">\r\n          <span>记住我</span>\r\n        </label>\r\n      </div>\r\n      <div nz-col [nzSpan]=\"12\">\r\n        <a class=\"login-form-forgot\">忘记密码</a>\r\n      </div>\r\n    </div>\r\n    -->\r\n\r\n    <div class=\"login-form-margin\">\r\n      <nz-alert *ngIf=\"errMsg\" nzType=\"error\" [nzMessage]=\"errMsg\"></nz-alert>\r\n    </div>\r\n    <button nz-button class=\"login-form-button login-form-margin\" [nzType]=\"'primary'\">登录</button>\r\n    <!--\r\n    或者 <a [routerLink]=\"['/sign-up']\"> 现在注册 </a>\r\n    -->\r\n  </form>\r\n</div>\r\n\r\n","import {NgModule} from '@angular/core';\r\nimport {LoginRoutingModule} from './login-routing.module';\r\nimport {CommonModule} from '@angular/common';\r\nimport {LoginComponent} from './login.component';\r\nimport {NzAlertModule, NzButtonModule, NzCheckboxModule, NzFormModule, NzInputModule} from 'ng-zorro-antd';\r\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\r\nimport {IconsProviderModule} from '../../icons-provider.module';\r\n\r\nconst APP_MODULES = [LoginRoutingModule];\r\nconst APP_COMPONENTS = [LoginComponent];\r\nconst NZ_MODULES = [IconsProviderModule, NzFormModule, NzButtonModule, NzInputModule, NzCheckboxModule, NzAlertModule];\r\nconst NG_MODULES = [CommonModule, FormsModule, ReactiveFormsModule];\r\n\r\n@NgModule({\r\n  declarations: [...APP_COMPONENTS],\r\n  imports: [...APP_MODULES, ...NZ_MODULES, ...NG_MODULES]\r\n})\r\nexport class LoginModule {\r\n\r\n}\r\n"],"sourceRoot":"webpack:///"}