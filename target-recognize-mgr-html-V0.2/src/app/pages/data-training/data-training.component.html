


<div class="flex-row" style="height: 100%;">
<div *ngIf="isVisible1" nzTitle="The first Modal"
class="statistics-top flex-column"
style="height: 80%;
width:70%;
position: absolute;
z-index: 9999;
background: #031129;
margin: 50px 10%;
">
<div class="statistics-title" style="position: relative;">比对结果
  <div class="close"
  style="width: 30px;height: 30px;position: absolute;right: 0px;top: 0px;"
  >
  <i nz-icon nzType="close" nzTheme="outline" style="cursor: pointer;" (click)="handleCancel1()"></i>
</div>

</div>



 <div class="dbcontent">
   <div class="dbCharts">
     <div class="dbtitle">
        <div class="leftLine"></div> <div class="leftRect"></div>
        <div class="titleText">模型精度曲线</div>
        <div class="rightRect"></div><div class="rightLine"></div>
     </div>
      <div id="lineCharts1" style="width: 100%;height:70%" ></div>
      <!-- [nzScroll]="{ x: '50%', y: '100%' }"      nzBordered -->
      <nz-table
       #basicTable
       [nzData]="tableData"
       [nzFrontPagination] = false
       [nzScroll]="{x: '', y: '100px'}"
       style="margin-left: 20px;text-align: center;margin-top: -25px;" >
        <thead>
          <tr>
            <th>训练版本</th>
            <th>训练精度</th>
            <th>Loss值</th>
            <th>数据总数</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of basicTable.data" [ngClass]="{'recomend': data.id == recommend}">
            <td  nzBreakWord >{{ data.taskName }}</td>
            <td  nzBreakWord>{{ data.precision }}</td>
            <td  nzBreakWord>{{ data.lossRate }}</td>
            <td  nzBreakWord>{{ data.samplesTotal }}</td>
          </tr>
        </tbody>
      </nz-table>

   </div>

   <div class="dbTable">
    <div class="dbtitle">
      <div class="leftLine"></div> <div class="leftRect"></div>
      <div class="titleText">分类数据详情</div>
      <div class="rightRect"></div><div class="rightLine"></div>
   </div>
   <!-- [nzScroll]="{ x: '1px', y: '24px' }" -->
   <!-- [nzScroll]="{ x: '50%', y: '100%' }" -->
    <nz-table #basicTable1
     [nzData]="tableData"
      [nzFrontPagination] = false
      [nzScroll]="{ x: '120px', y: '470px' }"
      style="margin-left: 20px;margin-top: 20px;" >
      <thead>
        <tr>
          <th *ngFor="let item of tableData"  [ngClass]="{'recomend': item.id == recommend}" style="min-width: 100px;" nzWidth="100px">{{item.taskName}}</th>
        </tr>
      </thead>
      <tbody>
        <!-- <tr *ngFor="let data of basicTable.data">
          <td nzBreakWord *ngFor="let item of data">{{ item.precision }}</td>
        </tr> -->
        <!-- *ngFor="let item of listOfData" -->
        <tr>
              <!-- <div *ngFor="let item of items.leftTableData">
                  {{item}}
              </div> -->
          <td nzBreakWord  *ngFor="let items of basicTable1.data" style="padding: 0;min-width: 100px;" [ngClass]="{'recomend': items.id == recommend}">
            <div *ngFor="let item of items.leftTableData" style="border-bottom: 1px solid #15a0ff;min-height:70px;text-align: center;padding-top: 15%;font-size: 12px;" >
              <!-- <span style="display:block;margin: 25% 0;">{{item}}</span> -->
              {{item}}
            </div>
          </td>

        </tr>

      </tbody>
    </nz-table>

   </div>


  </div>


</div>


<div *ngIf="isVisible2" nzTitle="The first Modal"
class="statistics-top flex-column"
style="height: 50%;
width: 80%;
position: absolute;
z-index: 9999;
background: #031129;
margin: 15% 5%;
display: flex;
">
<div class="statistics-title" style="position: relative;">下载

  <div class="close"
  style="width: 30px;height: 30px;position: absolute;right: 0px;top: 0px;"
  >
  <i nz-icon nzType="close" nzTheme="outline" style="cursor: pointer;" (click)="handleCancel2()"></i>
</div>

</div>
<div class="content">
  <div style=" flex:0 0 25%;padding: 2%; text-align: center;">
      <div class="img" style="    margin-bottom: 10px;width: 100%;height: 80%;">
          <svg t="1653127658106" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8122" width="200" height="200"><path d="M719.768116 237.449275H304.231884a59.362319 59.362319 0 0 0-59.362319 59.362319v415.536232a59.362319 59.362319 0 0 0 59.362319 59.362319h415.536232a59.362319 59.362319 0 0 0 59.362319-59.362319V296.811594a59.362319 59.362319 0 0 0-59.362319-59.362319z m0 474.898551H304.231884V296.811594h415.536232v415.536232z m267.130435-237.449275a29.681159 29.681159 0 0 0 0-59.362319h-103.884058v-89.043478h103.884058a29.681159 29.681159 0 0 0 0-59.362319h-103.884058v-50.265044A78.313739 78.313739 0 0 0 801.391304 133.565217H764.289855V29.681159a29.681159 29.681159 0 0 0-59.362319 0v103.884058h-89.043478V29.681159a29.681159 29.681159 0 0 0-59.362319 0v103.884058h-89.043478V29.681159a29.681159 29.681159 0 0 0-59.362319 0v103.884058h-89.043478V29.681159a29.681159 29.681159 0 0 0-59.362319 0v103.884058h-37.101449C173.516058 133.565217 126.144928 167.698551 126.144928 216.865391V267.130435H37.101449a29.681159 29.681159 0 0 0 0 59.362319h89.043479v89.043478H37.101449a29.681159 29.681159 0 0 0 0 59.362319h89.043479v89.043478H37.101449a29.681159 29.681159 0 0 0 0 59.362319h89.043479v89.043478H37.101449a29.681159 29.681159 0 0 0 0 59.362319h89.043479v23.937855A100.826899 100.826899 0 0 0 222.608696 890.434783H259.710145v103.884058a29.681159 29.681159 0 0 0 59.362319 0v-103.884058h89.043478v103.884058a29.681159 29.681159 0 0 0 59.362319 0v-103.884058h89.043478v103.884058a29.681159 29.681159 0 0 0 59.362319 0v-103.884058h89.043478v103.884058a29.681159 29.681159 0 0 0 59.362319 0v-103.884058h37.101449c49.092638 0 81.623188-45.694145 81.623189-94.786783V771.710145h103.884058a29.681159 29.681159 0 0 0 0-59.362319h-103.884058v-89.043478h103.884058a29.681159 29.681159 0 0 0 0-59.362319h-103.884058v-89.043478h103.884058zM823.652174 801.391304a29.681159 29.681159 0 0 1-29.68116 29.68116H215.188406a29.681159 29.681159 0 0 1-29.68116-29.68116V222.608696a29.681159 29.681159 0 0 1 29.68116-29.68116h578.782608a29.681159 29.681159 0 0 1 29.68116 29.68116v578.782608z" p-id="8123" fill="#3f4b61"></path></svg>
      </div>
      <button class="btn" (click)="download('cpu')">CPU计算</button>
  </div>
  <div style=" flex:0 0 25%;padding: 2%; text-align: center;">
    <div class="img" style="    margin-bottom: 10px;width: 100%;height: 80%;">
      <svg t="1653127701971" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9077" width="200" height="200"><path d="M651.9 120.8l114.7 114.7-21.2 21.2 28.3 28.3 41.8 41.8 28.3 28.3 21-21 28.6 28.6-35.4 35.4-28.3 28.3 21.3 21.3-241.8 241.7-21.3-21.3-28.3 28.3-35.3 35.3-28.3 28.4 21.3 21.3-121.2 121.2-263-263 518.8-518.8m-0.1-56.6l-21.3 21.3 0.1 0.1-554 554 298.3 298.3 21.3 21.3L574 781.4l-21.3-21.3 35.3-35.3 21.3 21.3 298.4-298.4-21.3-21.3 42.5-42.5 0.1-0.1 21-21-85.1-85.1-21 21-41.9-41.9 21.2-21.2L651.8 64.2z" p-id="9078" fill="#3f4b61"></path><path d="M374.9 528.8c29.6 0 57.4 11.5 78.3 32.4s32.4 48.7 32.4 78.3-11.5 57.4-32.4 78.3-48.7 32.4-78.3 32.4-57.4-11.5-78.3-32.4-32.4-48.7-32.4-78.3 11.5-57.4 32.4-78.3 48.7-32.4 78.3-32.4m0-40c-38.6 0-77.1 14.7-106.6 44.1-58.9 58.9-58.9 154.3 0 213.1 29.4 29.4 68 44.1 106.6 44.1S452 775.4 481.5 746c58.9-58.9 58.9-154.3 0-213.1-29.5-29.4-68.1-44.1-106.6-44.1z" p-id="9079" fill="#3f4b61"></path><path d="M374.9 639.5m-82.6 0a82.6 82.6 0 1 0 165.2 0 82.6 82.6 0 1 0-165.2 0Z" p-id="9080" fill="#3f4b61"></path><path d="M630.6 273.1c29.6 0 57.4 11.5 78.3 32.4s32.4 48.7 32.4 78.3-11.5 57.4-32.4 78.3-48.7 32.4-78.3 32.4-57.4-11.5-78.3-32.4-32.4-48.7-32.4-78.3 11.5-57.4 32.4-78.3 48.7-32.4 78.3-32.4m0-40c-38.6 0-77.1 14.7-106.6 44.1-58.9 58.9-58.9 154.3 0 213.1 29.4 29.4 68 44.1 106.6 44.1s77.1-14.7 106.6-44.1c58.9-58.9 58.9-154.3 0-213.1-29.4-29.4-68-44.1-106.6-44.1z" p-id="9081" fill="#3f4b61"></path><path d="M630.6 383.8m-82.6 0a82.6 82.6 0 1 0 165.2 0 82.6 82.6 0 1 0-165.2 0Z" p-id="9082" fill="#3f4b61"></path></svg>
    </div>
    <button class="btn"  (click)="download('gpu')">GPU计算</button>
</div>
<div style=" flex:0 0 25%;padding: 2%; text-align: center;">
  <div class="img" style="    margin-bottom: 10px;width: 100%;height: 80%;">
    <svg t="1653127773031" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10102" width="200" height="200"><path d="M870.4 661.312H960v59.712h-89.6v89.6c0 41.216-18.496 59.712-59.712 59.712h-89.6V960h-59.712v-89.6H541.888V960h-59.776v-89.6H362.688V960h-59.776v-89.6h-89.6c-41.216 0-59.712-18.496-59.712-59.712v-89.6H64v-59.712h89.6V541.888H64v-59.776h89.6V362.688H64v-59.712h89.6v-89.6c0-41.28 18.496-59.776 59.712-59.776h89.6V64h59.712v89.6h119.488V64h59.712v89.6h119.488V64h59.712v89.6h89.6c41.216 0 59.712 18.496 59.712 59.712v89.6H960v59.712h-89.6v119.488H960v59.712h-89.6v119.488z m-59.712-448H213.312v597.312h597.312V213.312zM332.8 302.912h358.4c20.608 0 29.888 9.216 29.888 29.888v358.4c0 20.608-9.28 29.888-29.888 29.888H332.8c-20.608 0-29.888-9.28-29.888-29.888V332.8c0-20.608 9.28-29.888 29.888-29.888z" p-id="10103" fill="#3f4b61"></path></svg>
  </div>
  <button class="btn"  (click)="download('hs')">海思NNIE</button>
</div>
<div style="flex:0 0 25%;padding: 2%; text-align: center;">
  <div class="img" style="    margin-bottom: 10px;width: 100%;height: 80%;">
    <svg t="1653127811070" class="icon" viewBox="0 0 1448 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11047" width="200" height="200"><path d="M960 268.8c-26.88-34.56-62.72-64-102.4-84.48-40.96-20.48-85.76-30.72-133.12-30.72-79.36 0-153.6 30.72-209.92 87.04-53.76 53.76-84.48 125.44-87.04 202.24-56.32 0-110.08 21.76-149.76 62.72-39.68 39.68-62.72 93.44-62.72 149.76 0 56.32 21.76 110.08 62.72 149.76 39.68 39.68 93.44 62.72 149.76 62.72h213.76c19.2 0 33.28-15.36 33.28-33.28 0-19.2-15.36-33.28-33.28-33.28H427.52c-38.4 0-74.24-15.36-101.12-42.24-26.88-26.88-42.24-64-42.24-101.12 0-38.4 15.36-74.24 42.24-101.12 26.88-26.88 64-42.24 101.12-42.24h34.56c8.96 0 17.92-3.84 25.6-11.52 6.4-7.68 8.96-16.64 8.96-25.6-1.28-7.68-1.28-15.36-1.28-23.04 0-61.44 24.32-119.04 66.56-162.56 43.52-43.52 101.12-66.56 162.56-66.56 35.84 0 70.4 7.68 102.4 24.32 30.72 15.36 57.6 38.4 78.08 65.28 6.4 8.96 16.64 12.8 26.88 12.8 7.68 0 14.08-2.56 20.48-7.68 7.68-5.12 11.52-14.08 12.8-23.04 2.56-12.8 0-21.76-5.12-28.16z m192 186.88c0-2.56-1.28-5.12-2.56-8.96l-1.28-2.56c-5.12-10.24-16.64-17.92-28.16-19.2H792.32c-14.08 0-25.6 7.68-32 19.2l-1.28 3.84c-1.28 2.56-1.28 5.12-2.56 7.68l-66.56 234.24c10.24-2.56 20.48-5.12 30.72-5.12h467.2c10.24 0 20.48 2.56 30.72 5.12L1152 455.68z m38.4 253.44H723.2c-25.6 0-46.08 20.48-46.08 44.8s20.48 57.6 46.08 57.6h467.2c25.6 0 46.08-32 46.08-57.6 1.28-24.32-20.48-44.8-46.08-44.8z m-47.36 75.52c-14.08 0-25.6-11.52-25.6-24.32 0-14.08 11.52-24.32 25.6-24.32s25.6 11.52 25.6 24.32-11.52 24.32-25.6 24.32z" p-id="11048" fill="#3f4b61"></path></svg>
  </div>
  <button class="btn"  (click)="download('zx')">在线服务</button>
</div>

</div>


  </div>


<div *ngIf="isVisible" nzTitle="The first Modal"
class="statistics-top flex-column"
style="height: 80%;
width: 80%;
position: absolute;
z-index: 9999;
background: #031129;
margin: 50px 5%;
">
<div class="statistics-title" style="position: relative;">模型精度：{{precision | taskProgress }} %

  <div class="close"
  style="width: 30px;height: 30px;position: absolute;right: 0px;top: 0px;"
  >
  <i nz-icon nzType="close" nzTheme="outline" style="cursor: pointer;" (click)="handleCancel()"></i>
</div>

</div>
<nz-tabset nzType="card" (nzSelectChange)="tabChange($event)" >
  <nz-tab nzTitle="模型精度曲线" >
    <div class="content">
      <div class="lineCharts" id="lineCharts"></div>
      <div class="main-content imgList" id="csImg1">
        <h2 class="title" style="font-size:18px">评价样本库中的识别错误</h2>
        <div class="image-list" style="width: 100%;max-height: 450px;overflow-y: auto;">
            <div class="cover" *ngFor="let item of jdcurver"><img [src]="item" alt=""></div>
        </div>
      </div>

  </div>
  </nz-tab>
  <nz-tab nzTitle="测  试">
      <div class="content" style="flex-wrap: wrap;">
        <div style="flex: 0 0 100%;margin-left: 20px;">
          <label for="upload" style="color: #fff;margin-right: 10px;">测试:  </label>
          <input type="file" multiple="true" accept="image/*" style="color: #fff;" id="imgInput" >
        </div>
        <div class="main-content imgList" id="csImg">
          <div class="image-list1" style="width: 100%;max-height: 450px;overflow-y: auto;" id="image-list1">

          </div>
        </div>
      </div>
  </nz-tab>
</nz-tabset>
  </div>

  <div class="train-left flex-row">
    <div class="train-area flex-column">
      <div class="train-area-btns flex-row">
        <button class="train-area-btn-item" [class.active]="flag === -1" (click)="changeStatus(-1)">排队中</button>
        <button class="train-area-btn-item" [class.active]="flag === 0" (click)="changeStatus(0)">进行中</button>
        <button class="train-area-btn-item" [class.active]="flag === 1" (click)="changeStatus(1)">已结束</button>
      </div>

      <div class="train-table-box" >
        <div class="train-btns" style="position:relative">

          <ng-container *ngIf="flag===1">
            <nz-select [(ngModel)]="selectData"
            (nzOpenChange)="nzOpenChange($event)"
             style="position: absolute;left:0;"
             class="select"
              (ngModelChange)="ngModelChange()"
              nzDropdownClassName="dropdown-style"
              >
              <nz-option  *ngFor="let item of selectList" [nzValue]="item" [nzLabel]="item"></nz-option>
            </nz-select>
          </ng-container>

          <ng-container *ngIf="flag===0">
            <button class="btn" (click)="endTask()">暂停</button>
          </ng-container>

          <ng-container *ngIf="compareDisplay">
            <button class="btn" (click)="startCompare()">开始对比</button>
          </ng-container>

          <ng-container *ngIf="flag===0">
            <button class="btn" (click)="trainResume()">继续训练</button>
          </ng-container>

          <button class="btn btn-remove" (click)="delete()">删除</button>
          <button class="btn btn-new-task" (click)="addTask(0)" *ngIf="status == 'LINE_UP'">新建任务</button>
        </div>

        <div class="flex-column">
          <nz-table class="blue-table" #rowSelectionTable nzShowSizeChanger [nzData]="listOfData"
                    [nzShowPagination]="false"
                    [nzTotal]="dataTotal" [(nzPageIndex)]="pageIndex" [(nzPageSize)]="pageSize"
                    [nzScroll]="{ y: '650px' }"
                    >
            <thead>
            <tr>
              <th
                [(nzChecked)]="isAllDisplayDataChecked"
                [nzIndeterminate]="isIndeterminate"
                (nzCheckedChange)="checkAll($event)"
              ></th>
              <th>任务名称</th>
              <th>数据源</th>
              <th>方式</th>
              <th>模式</th>
              <th>状态</th>
              <th>开始时间</th>
              <th *ngIf="flag === 1">操作</th>
              <th *ngIf="flag === 1">发布</th>
            </tr>
            </thead>
            <tbody style="padding: 20px;">
            <tr *ngFor="let data of listOfData;index as ids" (click)="tableClick(data.id,'handClick')" [class.current-row]="dataTrain?.id === data.id">
              <td nzShowCheckbox
                  [(nzChecked)]="mapOfCheckedId[data.id]"
                  (nzCheckedChange)="refreshStatus(ids)"></td>
              <td>{{ data.taskName }}</td>
              <td>{{ data.typeSourceName }}</td>
              <td>{{ data.taskMode | trainTaskMode}}</td>
              <td>{{ data.taskPattern |taskPattern}}</td>
              <td>{{ data.taskStatus | taskStatus}}</td>
              <td>{{ data.createdTime | date:'yyyy-MM-dd HH:mm:ss'}}</td>
              <td *ngIf="flag === 1">
                <button class="btn" (click)="checkModelPrecision($event,data)" style="width: 120px;">模型精度</button>
                <!--
                <span style="color: #FFF;background: #15a0ff;padding: 4px 8px;border-radius: 2px;cursor: pointer;"
                      (click)="checkModelPrecision($event,data)">模型精度</span>
                      -->
              </td>
              <td *ngIf="flag === 1">
                <button class="btn" (click)="download1($event, data)" style="width: 100px;">发布为</button>
              </td>
            </tr>
            </tbody>
          </nz-table>
        </div>
      </div>
    </div>
  </div>

  <ng-container *ngIf="rightComponent">
    <div class="train-right flex-column">
      <div class="train-classifies flex-column">
        <div class="train-title">任务进度</div>

        <div class="echart-box">
          <nz-progress [nzPercent]="dataTrain?.taskProgress|taskProgress" nzType="circle" nzStrokeColor="#159FFF"
                       nzStrokeWidth="12">
           </nz-progress>
        </div>
      </div>


      <div class="train-classifies flex-column" *ngIf="status == 'STATUS' || status == 'END'">
        <div class="train-title">精度曲线</div>
        <div class="lineCharts2" id="lineCharts2" #lineCharts2 style="height: 100%;">
        </div>
      </div>

      <div class="train-images flex-column">
        <div class="train-title">详细信息</div>

        <div class="detail-info-box flex-column">
          <div class="detail-info-type flex-row">
            <span class="detail-info-param">任务名称</span>
            <span class="detail-info-value">{{dataTrain?.taskName}}</span>
          </div>

          <div class="detail-info-type flex-row">
            <span class="detail-info-param">任务说明</span>
            <span class="detail-info-value">{{dataTrain?.taskPattern}}</span>
          </div>

          <div class="detail-info-type flex-row">
            <span class="detail-info-param">类别</span>
            <span class="detail-info-value">{{dataTrain?.typeSourceName}}</span>
          </div>

          <div class="detail-info-type flex-row">
            <span class="detail-info-param">应用场景</span>
            <span class="detail-info-value">{{dataTrain?.taskModeName}}</span>
          </div>

          <!-- <div class="detail-info-type flex-row">
            <span class="detail-info-param">任务模式</span>
            <span class="detail-info-value">{{dataTrain?.taskPattern |taskPattern}}</span>
          </div> -->

          <!-- <div class="detail-info-type flex-row">
            <span class="detail-info-param">触发条件</span>
            <span class="is_mark">每日</span>
          </div> -->

          <div class="detail-info-type flex-row">
            <span class="detail-info-param">任务方式</span>
            <span class="detail-info-value">{{ dataTrain?.taskMode | trainTaskMode}}</span>
          </div>

          <div class="detail-info-type flex-row">
            <span class="detail-info-param">学习率</span>
            <span class="detail-info-value">{{ dataTrain?.studyRate}}</span>
          </div>

        </div>

        <button class="btn train-btn-edit" (click)="addTask(dataTrain.id)">编辑</button>
      </div>
    </div>
  </ng-container>
</div>

<div class="model-compare" [class.show-compare]="showCompare">
  <div class="model-compare-title">
    <span>对比框</span>
    <i nz-icon nzType="close" nzTheme="outline" (click)="closeCompare()"></i>
  </div>
  <div class="compare-model-row" *ngFor="let cdt of comparingDataTrainList">
    <span>{{cdt.compareName}}</span>
    <i nz-icon nzType="close" nzTheme="outline" (click)="removeCompareItem(cdt)"></i>
  </div>


  <div class="model-compare-btn">
    <button class="btn" (click)="startCompare()">开始对比</button>
  </div>
  <div class="model-compre-del">
    <i nz-icon nzType="delete" nzTheme="outline"></i>
    <a nz-button nzType="link" (click)="clearCompare()">清空对比栏</a>
  </div>
</div>
